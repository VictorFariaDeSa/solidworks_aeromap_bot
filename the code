from pyautogui import *
import time
import pandas as pd
import pyperclip

def point_click(image,time=0,side='left',deslocx=0,deslocy=0,number=1):
    while True:
        if locateOnScreen(image) != None:
            x,y = locateCenterOnScreen(image)
            click(x=x+deslocx,y=y+deslocy,button=side,clicks=number)
            sleep(time)
            break

def check_swap_direction(image,value,deslocx=0,deslocy=0):
    if locateOnScreen(image) != None and value < 0:
        x,y = locateOnScreen(image)
        click(x=x+deslocx,y=y+deslocy) 

def standart_procedure(main_image,input_image,check_image,value):
    point_click(main_image,side = 'right')
    point_click('editar_recurso.png')
    check_swap_direction(check_image,value,deslocx= 'inserir desloc', deslocy = 'inserir desloc')
    point_click(input_image,deslocx = 100,number=2)
    write(value)
    point_click('check_menu.png')
    point_click('check.png')
    point_click('X_menu.png')

def save_file(name,path):
    point_click('Arquivo.png')
    point_click('Salvar_como.png')
    write(name)
    point_click('folder_name.png',deslocx=-100,number=1)
    press('del')
    pyperclip.copy(path)
    hotkey('cntl','v')
    press('enter')
    point_click('Salvar.png')

time.sleep(2)
data = pd.read_excel('planejamento_mapa.xlsx',sheet_name= 'leitura_python')
folder = f'C:\Users\savic\OneDrive\Área de Trabalho\automatização_setup'


FRH = data['FRH']
RRH = data['RRH']
ANG_DIR = data['graus_dir']
ANG_ESQ = data['graus_esq']
VOL_POS = data['vol_pos']
setups = {}

for i in range(len(data)):
    setups[f'teste{i}'] = [FRH[i],RRH[i],ANG_DIR[i],ANG_ESQ[i]]

for i in range(len(setups)):
    frh = str(FRH[i])
    rrh = str(RRH[i])
    ang_dir = str(ANG_DIR[i])
    ang_esq = str(ANG_ESQ[i])

    name = f'setup_FRH{FRH[i]}_RRH{RRH[i]}_volpos{VOL_POS[i]}°'
    standart_procedure('FRH.png','distancia.png','Inverter_dimensao.png',frh)
    standart_procedure('RRH.png','distancia.png','Inverter_dimensao.png',rrh)
    standart_procedure('roda_direita.png','angulo.png','Inverter_dimensao.png',ang_dir)
    standart_procedure('roda_esquerda.png','angulo.png','Inverter_dimensao.png',ang_esq)
    save_file(name,folder)
    point_click("Salvar.png")
